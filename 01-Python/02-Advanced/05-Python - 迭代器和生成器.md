# Pythonä¹‹è·¯ - è¿­ä»£å™¨å’Œç”Ÿæˆå™¨

## å¯è¿­ä»£å¯¹è±¡  ğŸ€

åœ¨Pythonä¸­ä¸€åˆ‡çš†å¯¹è±¡

è¿­ä»£æ˜¯é‡å¤åé¦ˆè¿‡ç¨‹çš„æ´»åŠ¨ , å…¶ç›®çš„é€šå¸¸æ˜¯ä¸ºäº†é€¼è¿‘æ‰€éœ€ç›®æ ‡æˆ–ç»“æœ 

å¯è¿­ä»£å¯¹è±¡ , å³å¯ä»¥æŒ‰ç…§è¿­ä»£çš„æ–¹å¼è¿›è¡Œå­˜å–æ•°æ®çš„å¯¹è±¡ , åœ¨pythonä¸­æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºå¯ä»¥ç”¨forå¾ªç¯éå†çš„å¯¹è±¡å°±æ˜¯å¯è¿­ä»£å¯¹è±¡

__forå¾ªç¯åšçš„é‚£äº›äº‹__ :  forå¾ªç¯æ˜¯æˆ‘ä»¬ç”¨æ¥éå†ä¸€ä¸ªæ•°æ®é›†åˆçš„æ–¹æ³• , å…¶å®å°±æ˜¯æ ¹æ®ä¸€å®šçš„è¦æ±‚ (è¿™ä¸ªè¦æ±‚å«åš'åè®®' ) è¿›è¡Œä¸€æ¬¡æ¬¡çš„è¿­ä»£çš„æ•ˆæœ . å½“æˆ‘ä»¬ç”¨forå¾ªç¯å»éå†æ—¶ , å®ƒåšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ˜¯å¯è¿­ä»£å¯¹è±¡ , å¦‚æœæ˜¯ , é‚£ä¹ˆå®ƒå°±ä¼šå°†è¯¥å¯¹è±¡è½¬æ¢æˆä¸€ä¸ªè¿­ä»£å™¨ , æœ€ååˆ©ç”¨` __next__() `æ–¹æ³•å°†è¿­ä»£å™¨ä¸­çš„å†…å®¹ä¸€ä¸ªæ¥ä¸€ä¸ªçš„å–å‡ºæ¥

å¯è¿­ä»£å¯¹è±¡çš„æ ‡å¿—æ˜¯ , å®ƒå…·æœ‰` __iter__() `æ–¹æ³•

åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºå¯è¿­ä»£å¯¹è±¡æ–¹æ³•å¦‚ä¸‹:

```python
# å¯¼å…¥æ¨¡å—
>>> from collections import Iterable
>>> l = ['lyon','oldboy']
# åˆ¤æ–­æ˜¯å¦ä¸ºIterable , å³å¯è¿­ä»£å¯¹è±¡
>>> isinstance(l,Iterable)
# è¿”å›boolå€¼
True
```

## è¿­ä»£å™¨  ğŸ€

é€šè¿‡ä¸Šé¢çš„å†…å®¹å·²ç»çŸ¥é“` forå¾ªç¯ `æœ‰ä¸€ä¸ªç”Ÿæˆè¿­ä»£å™¨çš„è¿‡ç¨‹ , è¿­ä»£å™¨æ˜¯å•¥ ?

è¿­ä»£å™¨æ˜¯è®¿é—®é›†åˆå…ƒç´ çš„ä¸€ç§æ–¹å¼

ç‰¹ç‚¹:

1. ä¸ä¾èµ–ç´¢å¼•å–å€¼ , è®¿é—®è€…ä¸éœ€è¦å…³å¿ƒè¿­ä»£å™¨å†…éƒ¨çš„ç»“æ„ , ä»…éœ€é€šè¿‡next()æ–¹æ³•å»è®¿é—®
2. ä¸èƒ½éšæœºè®¿é—®é›†åˆä¸­çš„æŸä¸ªå€¼ , åªèƒ½ä»å¤´åˆ°å°¾ä¾æ¬¡è®¿é—® , ä¸å¯è¿”å›è®¿é—®
3. æƒ°æ€§è®¡ç®— , åªæœ‰åœ¨éœ€è¦è®¿é—®æ—¶æ‰ä¼šç”Ÿæˆå€¼ , èŠ‚çœå†…å­˜

åœ¨pythonä¸­æœ‰ä¸€ä¸ª`iter()`æ–¹æ³• , ä½œç”¨å°±æ˜¯å°†å¯è¿­ä»£å¯¹è±¡å˜æˆä¸€ä¸ªè¿­ä»£å™¨ , å®è´¨ä¸Šiter()æ˜¯å»è°ƒç”¨äº†` __iter__() `æ–¹æ³• ,  çœ‹ä»£ç :

```python
>>> l = ['lyon']
>>> l.__iter__()
# iteratorå³è¿­ä»£å™¨
<list_iterator object at 0x0000026DA649D320>
```

å¯è¿­ä»£å¯¹è±¡ä¸è¿­ä»£å™¨çš„åŒºåˆ«:

```python
# ç”¨diræ–¹æ³•æŸ¥çœ‹å¯¹è±¡ä¸­çš„æ‰€æœ‰æ–¹æ³•
>>> dir_list = dir([1,2])
>>> dir_iter = dir([1,2].__iter__())
# ç­›é€‰å‡ºä¸åŒç‚¹
>>> set(dir_iter) - set(dir_list)
{'__length_hint__', '__setstate__', '__next__'}
```

æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿­ä»£å™¨æ¯”å¯è¿­ä»£å¯¹è±¡å¤šå‡ºäº†ä¸‰ä¸ªæ–¹æ³• , æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸€ç‚¹æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡åˆ°åº•æ˜¯å¯è¿­ä»£å¯¹è±¡è¿˜æ˜¯ä¸€ä¸ªè¿­ä»£å™¨

```python
# åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨
>>> i = iter([1,2,3,4])
# æŸ¥çœ‹è¿­ä»£å™¨ä¸­å…ƒç´ çš„é•¿åº¦
>>> i.__length_hint__()
4
# æ ¹æ®ç´¢å¼•æŒ‡å®šè¿­ä»£å¼€å§‹ä½ç½®
>>> i.__setstate__(3)
# è¿›è¡Œå–å€¼
>>> i.__next__()
4
```

*åˆ¤æ–­æ–¹æ³•:* 

```python
# å¯¼å…¥Iterableç±»
>>> from collections import Iterable
# å¯¼å…¥Iteratorç±»
>>> from collections import Iterator
# æ˜¯å¦ä¸ºå¯è¿­ä»£å¯¹è±¡
>>> isinstance(obj,Iterable)
# æ˜¯å¦ä¸ºè¿­ä»£å™¨
>>> isinstance(obj,Iterator)
# æ³¨æ„:è¿­ä»£å™¨ä¹Ÿæ˜¯å¯è¿­ä»£å¯¹è±¡
```

*** åœ¨è¿­ä»£æ—¶ ,  æˆ‘ä»¬éœ€è¦æ³¨æ„è¿­ä»£å™¨ä¸­æ˜¯å¦æœ‰å€¼çš„é—®é¢˜ ,  å³å½“æˆ‘ä»¬ä¸€ç›´è°ƒç”¨` __next__ ` æ–¹æ³•å–å€¼æ—¶ , å¦‚æœå€¼éƒ½å–å®Œäº† , è€Œæ­¤æ—¶æˆ‘ä»¬å†æ‰§è¡Œ ` __next__ ` æ–¹æ³• , è§£é‡Šå™¨å°±ä¼šæŠ›å‡º StopIteration , å› ä¸ºå·²ç»æ²¡æœ‰å€¼å¯ä»¥å–äº† ***

## ç”Ÿæˆå™¨  ğŸ€

è‡ªå®šä¹‰çš„ä¸€ä¸ªèƒ½å¤Ÿå®ç°è¿­ä»£å™¨åŠŸèƒ½çš„å°±æ˜¯ç”Ÿæˆå™¨

æœ¬è´¨: è¿­ä»£å™¨(æ‰€ä»¥è‡ªå¸¦äº†` __iter__ ` æ–¹æ³•å’Œ` __next__ ` ä¸éœ€è¦æˆ‘ä»¬å»å®ç°

ç‰¹ç‚¹: æƒ°æ€§è¿ç®— , å¼€å‘è€…è‡ªå®šä¹‰

### ç”Ÿæˆå™¨å‡½æ•°  ğŸ€

ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ , é‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±å«åšç”Ÿæˆå™¨å‡½æ•°

åˆ©ç”¨ç”Ÿæˆå™¨åšä¸€ä¸ªrange( 2.xä¸­çš„xrange ) çš„åŠŸèƒ½

```python
# å®šä¹‰å‡½æ•°
>>> def range(n):
...		start = 0
... 	while start < n:
... 		yield start
...			start += 1
>>> obj = range(5)
>>> obj.__next__()
>>> obj.__next__()
>>> obj.__next__()
>>> obj.__next__()
>>> obj.__next__()
```

yieldçš„ä½œç”¨ :  yieldçš„ä½œç”¨æ˜¯ä¸­æ–­å‡½æ•°çš„æ‰§è¡Œå¹¶è®°å½•ä¸­æ–­çš„ä½ç½® , ç­‰ä¸‹æ¬¡é‡æ–°è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶ , å°±ä¼šæ¥ç€ä¸Šæ¬¡ç»§ç»­æ‰§è¡Œ

PS : è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°æ—¶ , ä»…ä»…ä¼šè¿”å›ä¸€ä¸ªç”Ÿæˆå™¨ , å¹¶ä¸ä¼šæ‰§è¡Œå‡½æ•°çš„å†…å®¹ , ç”Ÿæˆå™¨åªèƒ½ç”±next() è¿›è¡Œè°ƒç”¨æ‰§è¡Œ , å®è´¨ä¸Šnext()æ–¹æ³•å°±æ˜¯è°ƒç”¨çš„` __next__() `  æ–¹æ³•

***yield from***

```python
def func1():
    for i in 'AB':
        yield i
    for j in range(3):
        yield j
print(list(func()))

def func2():
    yield from 'AB'
    yield from range(3)
    
print(list(func2()))
```

**ç”Ÿæˆå™¨åº”ç”¨**

ç›‘å¬æ–‡ä»¶

```python
import time
def tail(filename):
    # æ‰“å¼€æ–‡ä»¶
    f = open(filename,encoding='utf-8')
    # ä»æ–‡ä»¶æœ«å°¾ç®—èµ·
    f.seek(0, 2) 
    while True:
        # è¯»å–æ–‡ä»¶ä¸­æ–°çš„æ–‡æœ¬è¡Œ
        line = f.readline()  
        if not line:
            time.sleep(0.1)
            continue
        yield line
tail_g = tail('tmp')
# ç”Ÿæˆå™¨ä¹Ÿæ˜¯å¯è¿­ä»£å¯¹è±¡
for line in tail_g:
    print(line)
```

è®¡ç®—åŠ¨æ€å¹³å‡å€¼

```python
def averager():
	total = 0
    count = 0
    average = None
    while True:
        term = yield average
        total += term
        count += 1
        average = total/count
# ç”Ÿæˆç”Ÿæˆå™¨
g_avg = averager()
# æ¿€æ´»ç”Ÿæˆå™¨,ä¸æ¿€æ´»æ— æ³•send
next(g_avg)
# sendç›¸å½“äºå…ˆä¼ å‚,åè°ƒç”¨next()
print(g_avg.send(10))
print(g_avg.send(30))
print(g_avg.send(50))
```

### åˆ—è¡¨æ¨å¯¼å¼å’Œç”Ÿæˆå™¨è¡¨è¾¾å¼  ğŸ€

```python
# åˆ—è¡¨è§£æ
>>> num = [i for i in range(10)]
>>> num
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
# ç”Ÿæˆå™¨è¡¨è¾¾å¼
>>> num_iter = (i for i in range(10))
>>> num_iter
<generator object <genexpr> at 0x0000021C41003258>
>>> next(num_iter)
0
>>> next(num_iter)
1
>>> next(num_iter)
2
>>> next(num_iter)
3
>>> next(num_iter)
4
>>> next(num_iter)
```

å¯¹äºæ¨å¯¼å¼ä¼šæœ‰å¦ä¸€ç¯‡ä¸“é—¨æ¥å†™