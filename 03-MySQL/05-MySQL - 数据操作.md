# MySQL - Êï∞ÊçÆÊìç‰Ωú








<extoc></extoc>

## ‰ªãÁªç  üçÄ

DMLÊìç‰ΩúÊòØÊåáÂØπÊï∞ÊçÆÂ∫ì‰∏≠Ë°®ËÆ∞ÂΩïÁöÑÊìç‰Ωú , Âç≥Êï∞ÊçÆÊìç‰Ωú

‰∏ªË¶ÅÂåÖÊã¨Ë°®ËÆ∞ÂΩïÁöÑÊèíÂÖ•(insert) , Êõ¥Êñ∞(update) , Âà†Èô§(delete) ÂíåÊü•ËØ¢(select) , ÊòØÂºÄÂèë‰∫∫ÂëòÊó•Â∏∏‰ΩøÁî®ÊúÄÈ¢ëÁπÅÁöÑÊìç‰Ωú

## ÊèíÂÖ•ËÆ∞ÂΩï  üçÄ

ËØ≠Ê≥ï : 

```mysql
INSERT INTO tablename(field1,field2,...,fieldn) VALUES(value1,value2,...,valuen);
```

ÂÆû‰æã : 

```mysql
mysql> DESC emp;
+----------+---------------+------+-----+---------+-------+
| Field    | Type          | Null | Key | Default | Extra |
+----------+---------------+------+-----+---------+-------+
| ename    | varchar(10)   | YES  |     | NULL    |       |
| hiredate | date          | YES  |     | NULL    |       |
| sal      | decimal(10,2) | YES  |     | NULL    |       |
| deptno   | int(2)        | YES  |     | NULL    |       |
+----------+---------------+------+-----+---------+-------+
4 rows in set (0.00 sec)
-- ÊèíÂÖ•Êï∞ÊçÆ,values‰∏≠ÁöÑÈ°∫Â∫èÈúÄÊéíÂàó‰∏ÄËá¥
mysql> INSERT INTO emp(ename,hiredate,sal,deptno) VALUES('lyon','2000-01-01','2000',1);
Query OK, 1 row affected (0.08 sec)
-- ÊèíÂÖ•Á¨¨‰∫åÊù°Êï∞ÊçÆ
mysql> INSERT INTO emp(ename,hiredate,sal,deptno) VALUES('kenneth','2000-01-01','1000',2);
Query OK, 1 row affected (0.10 sec)
-- Ê≤°ÂÜôÁöÑÂ≠óÊÆµËá™Âä®ËÆæÁΩÆ‰∏∫NULL,ÈªòËÆ§ÂÄº,Ëá™Â¢ûÁöÑ‰∏ã‰∏Ä‰∏™Êï∞Â≠ó
mysql> INSERT INTO emp(ename,sal) VALUES('alex',500);
Query OK, 1 row affected (0.24 sec)
-- Êü•ÁúãempË°®‰∏≠ÁöÑÊâÄÊúâËÆ∞ÂΩï
mysql> SELECT * FROM emp;
+---------+------------+---------+--------+
| ename   | hiredate   | sal     | deptno |
+---------+------------+---------+--------+
| lyon    | 2000-01-01 | 2000.00 |      1 |
| kenneth | 2000-01-01 | 1000.00 |      2 |
| alex    | NULL       |  500.00 |   NULL |
+---------+------------+---------+--------+
3 rows in set (0.00 sec)
```

‰∏ÄÊ¨°ÊÄßÊèíÂÖ•Â§öÊù° : 

```mysql
INSERT INTO tablename(field1,field2,...,fieldn) VALUES
(value1,value2,...,valuen),  -- ‰ª•ÈÄóÂè∑ÂàÜÈöî
(value1,value2,...,valuen),
(value1,value2,...,valuen),
(value1,value2,...,valuen);
```


## Êõ¥Êñ∞ËÆ∞ÂΩï  üçÄ

ËØ≠Ê≥ï : 

```mysql
UPDATE tablename SET field1=value1,field2=value2,...,fieldn=valuen [WHERE CONDITION];
```

ÂÆû‰æã : 

```mysql
mysql> UPDATE emp SET sal=100000 WHERE ename='lyon';
Query OK, 1 row affected (0.10 sec)
Rows matched: 1  Changed: 1  Warnings: 0
```

ÂêåÊó∂Êõ¥Êñ∞Â§ö‰∏™Ë°®‰∏≠Êï∞ÊçÆ

```mysql
UPDATE t1,t2,...,tn SET t1.field1=expr1,tn.fieldn=exprn [WHERE CONDITION];
```


## Âà†Èô§ËÆ∞ÂΩï  üçÄ

ËØ≠Ê≥ï : 

```mysql
DELETE FROM tablename [WHERE CONDITION];
```

ÂÆû‰æã : 

```mysql
mysql> DELETE FROM emp WHERE ename='alex';
Query OK, 1 row affected (0.06 sec)
```

‰∏ÄÊ¨°Âà†Èô§Â§ö‰∏™Ë°®ÁöÑÊï∞ÊçÆ

```mysql
DELETE t1,t2,...,tn FROM t1,t2,...,tn [WHERE CONDITION];
```

ÂÆû‰æã : 

```mysql
-- Êü•ËØ¢ËÆ∞ÂΩï
mysql> SELECT * FROM dept;
+--------+----------+
| deptno | deptname |
+--------+----------+
|      1 | tech     |
|      2 | sale     |
|      3 | hr       |
+--------+----------+
3 rows in set (0.00 sec)
-- Êü•ËØ¢ËÆ∞ÂΩï
mysql> SELECT * FROM emp;
+---------+------------+-----------+--------+
| ename   | hiredate   | sal       | deptno |
+---------+------------+-----------+--------+
| lyon    | 2000-01-01 | 100000.00 |      1 |
| kenneth | 2000-01-01 |   1000.00 |      2 |
+---------+------------+-----------+--------+
2 rows in set (0.00 sec)
-- Âà†Èô§‰∏§‰∏™Ë°®‰∏≠deptno‰∏∫2ÁöÑËÆ∞ÂΩï
mysql> DELETE a,b FROM emp a,dept b WHERE a.deptno=b.deptno and a.deptno=2;
Query OK, 2 rows affected (0.11 sec)
-- Êü•ËØ¢ËÆ∞ÂΩï
mysql> SELECT * FROM emp;
+-------+------------+-----------+--------+
| ename | hiredate   | sal       | deptno |
+-------+------------+-----------+--------+
| lyon  | 2000-01-01 | 100000.00 |      1 |
+-------+------------+-----------+--------+
1 row in set (0.00 sec)
-- Êü•ËØ¢ËÆ∞ÂΩï
mysql> SELECT * FROM dept;
+--------+----------+
| deptno | deptname |
+--------+----------+
|      1 | tech     |
|      3 | hr       |
+--------+----------+
2 rows in set (0.00 sec)
```

PS : ‰∏çÁÆ°ÊòØÂçïË°®ËøòÊòØÂ§öË°® , ‰∏çÂä†whereÊù°‰ª∂‰ºöÊääË°®ÁöÑÊâÄÊúâËÆ∞ÂΩïÂà†Èô§ , ÊâÄ‰ª•Êìç‰ΩúÊó∂‰∏ÄÂÆöË¶ÅÂ∞èÂøÉ


## Êü•ËØ¢ËÆ∞ÂΩï  üçÄ

ËØ≠Ê≥ï : 

```mysql
SELECT * FROM tablename [WHERE CONDITION];
```

"*"Ë°®Á§∫Ë¶ÅÂ∞ÜÊâÄÊúâÁöÑËÆ∞ÂΩïÈÉΩÈÄâÂá∫Êù• , ‰πüÂèØ‰ª•Áî®ÈÄóÂè∑ÂàÜÂâ≤ÊâÄÊúâÁöÑÂ≠óÊÆµÊù•‰ª£Êõø

Â¶Ç‰∏äÈù¢‰æãÂ≠ê‰∏≠

```mysql
mysql> SELECT ename,hiredate,sal,deptno FROM emp;
```


### Êü•ËØ¢‰∏çÈáçÂ§çÁöÑËÆ∞ÂΩï  üçÄ

```mysql
mysql> SELECT DISTINCT deptno FROM emp;
+--------+
| deptno |
+--------+
|      1 |
+--------+
1 row in set (0.00 sec)
```


### Êù°‰ª∂Êü•ËØ¢  üçÄ

```mysql
mysql> SELECT * FROM emp WHERE deptno=1;
+-------+------------+-----------+--------+
| ename | hiredate   | sal       | deptno |
+-------+------------+-----------+--------+
| lyon  | 2000-01-01 | 100000.00 |      1 |
+-------+------------+-----------+--------+
1 row in set (0.00 sec)
```


### ÊéíÂ∫èÂíåÈôêÂà∂   üçÄ

```mysql
-- ÊåâÂ∑•ËµÑÈ´ò‰ΩéËøõË°åÊòæÁ§∫
mysql> SELECT * FROM emp order by sal;
+---------+------------+-----------+--------+
| ename   | hiredate   | sal       | deptno |
+---------+------------+-----------+--------+
| kenneth | 2000-01-01 |   5000.00 |      2 |
| alex    | 2000-01-01 |   8000.00 |      3 |
| lyon    | 2000-01-01 | 100000.00 |      1 |
+---------+------------+-----------+--------+
3 rows in set (0.00 sec)
```

ÂØπ‰∫éÊéíÂ∫èÂêéÁöÑËÆ∞ÂΩï , Â¶ÇÊûúÂ∏åÊúõÂè™ÊòæÁ§∫‰∏ÄÈÉ®ÂàÜ , ÂèØ‰ª•‰ΩøÁî®LIMITÂÖ≥ÈîÆÂ≠óÊù•ÂÆûÁé∞

```mysql
SELECT ...[LIMIT offset_start,row_count]
-- offset_startË°®Á§∫ËÆ∞ÂΩïÁöÑËµ∑ÂßãÂÅèÁßªÈáè,ÈªòËÆ§‰∏∫0;row_countË°®Á§∫ÊòæÁ§∫ÁöÑË°åÊï∞
```

ÂÆû‰æã

```mysql
mysql> SELECT * FROM emp ORDER BY sal LIMIT 2;
+---------+------------+---------+--------+
| ename   | hiredate   | sal     | deptno |
+---------+------------+---------+--------+
| kenneth | 2000-01-01 | 5000.00 |      2 |
| alex    | 2000-01-01 | 8000.00 |      3 |
+---------+------------+---------+--------+
2 rows in set (0.00 sec)
```

PS : limitÂ±û‰∫éMySQLÊâ©Â±ïSQL92ÂêéÁöÑËØ≠Ê≥ï , Âú®ÂÖ∂‰ªñÊï∞ÊçÆÂ∫ì‰∏äÂπ∂‰∏çËÉΩÈÄöÁî®


### ËÅöÂêà  üçÄ

Áî®‰∫éËøõË°åÊ±áÊÄªÊìç‰Ωú

ËØ≠Ê≥ï : 

```mysql
SELECT [field1,field2,...,fieldn] fun_name
FROM tablename
[WHERE where_condition]
[GROUP BY field1,dield2,,...,fieldn
[WITH ROLLUP]]
[HAVING where_contition]
/* ÂèÇÊï∞ËØ¥Êòé */
fun_name Ë°®Á§∫Ë¶ÅÂÅöÁöÑËÅöÂêàÊìç‰Ωú,‰πüÂ∞±ÊòØËÅöÂêàÂáΩÊï∞,Â∏∏Áî®ÁöÑÊúâ sum(Ê±ÇÂíå),count(*)(ËÆ∞ÂΩïË°®),max(ÊúÄÂ§ßÂÄº),min(ÊúÄÂ∞èÂÄº)
GROUP BY ÂÖ≥ÈîÆÂ≠óË°®Á§∫Ë¶ÅËøõË°åÂàÜÁ±ªËÅöÂêàÁöÑÂ≠óÊÆµ,ÊØîÂ¶ÇË¶ÅÊåâÁÖßÈÉ®Èó®ÂàÜÁ±ªÁªüËÆ°ÂëòÂ∑•Êï∞Èáè,ÈÉ®Èó®Â∞±Â∫îËØ•ÂÜôÂú® group byÂêéÈù¢
WITH ROLLUP ÊòØÂèØÈÄâËØ≠Ê≥ï,Ë°®ÊòéÊòØÂê¶ÂØπÂàÜÁ±ªËÅöÂêàÂêéÁöÑÁªìÊûúËøõË°åÂÜçÊ±áÊÄª
HAVING ÂÖ≥ÈîÆÂ≠óË°®Á§∫ÂØπÂàÜÁ±ªÂêéÁöÑÁªìÊûúÂÜçËøõË°åÊù°‰ª∂ÁöÑËøáÊª§
-- Ê≥®ÊÑè :
having Âíå whereÁöÑÂå∫Âà´Âú®‰∫é,havingÊòØÂØπËÅöÂêàÂêéÁöÑÁªìÊûúËøõË°åÊù°‰ª∂ÁöÑËøáÊª§,ËÄå whereÊòØÂú®ËÅöÂêàÂâçÂ∞±ÂØπËÆ∞ÂΩïËøõË°åËøáÊª§,ÊâÄ‰ª•Êàë‰ª¨Â∫îËØ•Â∞ΩÂèØËÉΩÁî® whereÂÖàËøáÊª§ËÆ∞ÂΩï,‰ΩøÁªìÊûúÈõÜÂáèÂ∞è,‰ºöÂØπËÅöÂêàÁöÑÊïàÁéáÂ§ßÂ§ßÊèêÈ´ò
```

ÂÆû‰æã : 

```mysql
/* ÁªüËÆ°empË°®‰∏≠ÂÖ¨Âè∏ÁöÑÊÄª‰∫∫Êï∞ */
mysql> SELECT count(1) FROM emp;
+----------+
| count(1) |
+----------+
|        5 |
+----------+
1 row in set (0.00 sec)
/* ÁªüËÆ°‰∏™ÈÉ®Èó®ÁöÑÊÄª‰∫∫Êï∞ */
mysql> SELECT count(1) FROM emp GROUP BY deptno;
+----------+
| count(1) |
+----------+
|        2 |
|        2 |
|        1 |
+----------+
3 rows in set (0.00 sec)
/* Êó¢ÁªüËÆ°ÂêÑÈÉ®Èó®‰∫∫Êï∞,ÂèàÁªüËÆ°ÊÄª‰∫∫Êï∞ */
mysql> SELECT deptno,count(1) FROM emp GROUP BY deptno WITH ROLLUP;
+--------+----------+
| deptno | count(1) |
+--------+----------+
|      1 |        2 |
|      2 |        2 |
|      3 |        1 |
|   NULL |        5 |
+--------+----------+
4 rows in set (0.00 sec)
/* ÁªüËÆ°‰∫∫Êï∞Â§ß‰∫é1ÁöÑÈÉ®Èó® */
mysql> SELECT deptno,count(1) FROM emp GROUP BY deptno HAVING count(1)>1;
+--------+----------+
| deptno | count(1) |
+--------+----------+
|      1 |        2 |
|      2 |        2 |
+--------+----------+
2 rows in set (0.00 sec)
/* ÁªüËÆ°ÂÖ¨Âè∏ÊâÄÊúâÂëòÂ∑•ÁöÑËñ™Ê∞¥ÊÄªÈ¢ù,ÊúÄÈ´òÂíåÊúÄ‰ΩéËñ™Ê∞¥ */
mysql> SELECT sum(sal),max(sal),min(sal) FROM emp;
+-----------+-----------+----------+
| sum(sal)  | max(sal)  | min(sal) |
+-----------+-----------+----------+
| 113000.00 | 100000.00 |  5000.00 |
+-----------+-----------+----------+
1 row in set (0.00 sec)
```


### Ë°®ËøûÊé•  üçÄ

ÂêåÊó∂ÊòæÁ§∫Â§ö‰∏™Ë°®‰∏≠ÁöÑÂ≠óÊÆµ , ÂàÜ‰∏∫ÂÜÖËøûÊé•ÂíåÂ§ñËøûÊé•

ÂÜÖËøûÊé•‰ªÖÈÄâÂá∫‰∏§Âº†Ë°®‰∏≠‰∫íÁõ∏ÂåπÈÖçÁöÑËÆ∞ÂΩï , Â§ñËøûÊé•‰ºöÈÄâÂá∫ÂÖ∂‰ªñ‰∏çÂåπÈÖçÁöÑËÆ∞ÂΩï , Êàë‰ª¨ÊúÄÂ∏∏Áî®ÁöÑÊòØÂÜÖËøûÊé•

Â§ñËøûÊé•ÂèàÂàÜ‰∏∫Â∑¶ËøûÊé•ÂíåÂè≥ËøûÊé•

ÂÜÖËøûÊé• : 

```mysql
mysql> SELECT * FROM emp;
+---------+------------+-----------+--------+
| ename   | hiredate   | sal       | deptno |
+---------+------------+-----------+--------+
| lyon    | 2000-01-01 | 100000.00 |      1 |
| kenneth | 2000-01-01 |   5000.00 |      2 |
| alex    | 2000-01-01 |   8000.00 |      3 |
| egon    | NULL       |      NULL |      1 |
| eva     | NULL       |      NULL |      2 |
+---------+------------+-----------+--------+
5 rows in set (0.00 sec)

mysql> SELECT * FROM dept;
+--------+----------+
| deptno | deptname |
+--------+----------+
|      1 | tech     |
|      3 | hr       |
|      2 | sale     |
+--------+----------+
3 rows in set (0.00 sec)

mysql> SELECT ename,deptname FROM emp,dept WHERE emp.deptno=dept.deptno;
+---------+----------+
| ename   | deptname |
+---------+----------+
| lyon    | tech     |
| kenneth | sale     |
| alex    | hr       |
| egon    | tech     |
| eva     | sale     |
+---------+----------+
5 rows in set (0.00 sec)
```

Â§ñËøûÊé• : 

Ê†πÊçÆ‰∏äËø∞ÂÆû‰æã , ËØ≠Âè•‰∏∫

Â∑¶ËøûÊé• : `SELECT ename,deptname FROM emp LEFT JOIN dept ON emp.deptno=dept.deptno;`

Âè≥ËøûÊé• : `SELECT ename,deptname FROM emp RIGHT JOIN dept ON emp.deptno=dept.deptno;`



### Â≠êÊü•ËØ¢  üçÄ

Êü•ËØ¢Êó∂ , ÈúÄË¶ÅÁöÑÊù°‰ª∂ÊòØÂè¶‰∏Ä‰∏™selectËØ≠Âè•ÁöÑÁªìÊûú

```mysql
mysql> SELECT * FROM emp WHERE deptno in(SELECT deptno FROM dept);
+---------+------------+-----------+--------+
| ename   | hiredate   | sal       | deptno |
+---------+------------+-----------+--------+
| lyon    | 2000-01-01 | 100000.00 |      1 |
| kenneth | 2000-01-01 |   5000.00 |      2 |
| alex    | 2000-01-01 |   8000.00 |      3 |
| egon    | NULL       |      NULL |      1 |
| eva     | NULL       |      NULL |      2 |
+---------+------------+-----------+--------+
5 rows in set (0.00 sec)
```

Â¶ÇÊûúÂ≠êÊü•ËØ¢ËÆ∞ÂΩïÊï∞ÂîØ‰∏Ä , ÂèØ‰ª•Áî® = ‰ª£Êõø in , Âç≥`SELECT * FROM emp WHERE deptno = (SELECT deptno FROM dept);` 

Êüê‰∫õÊÉÖÂÜµ‰∏ã , Â≠êÊü•ËØ¢ÂèØ‰ª•ËΩ¨Âåñ‰∏∫Ë°®ËøûÊé• , Â¶Ç‰∏ã

```mysql
mysql> SELECT * FROM emp WHERE deptno in(SELECT deptno FROM dept);
+---------+------------+-----------+--------+
| ename   | hiredate   | sal       | deptno |
+---------+------------+-----------+--------+
| lyon    | 2000-01-01 | 100000.00 |      1 |
| kenneth | 2000-01-01 |   5000.00 |      2 |
| alex    | 2000-01-01 |   8000.00 |      3 |
| egon    | NULL       |      NULL |      1 |
| eva     | NULL       |      NULL |      2 |
+---------+------------+-----------+--------+
5 rows in set (0.00 sec)
```

PS : 

- MySQL 4.1 ‰ª•ÂâçÁöÑÁâàÊú¨‰∏çÊîØÊåÅÂ≠êÊü•ËØ¢ , ÈúÄË¶ÅÁî®Ë°®ËøûÊé•Êù•ÂÆûÁé∞Â≠êÊü•ËØ¢
- Ë°®ËøûÊé•Âú®ÂæàÂ§öÊÉÖÂÜµ‰∏ãÁî®‰∫é‰ºòÂåñÂ≠êÊü•ËØ¢


### ËÆ∞ÂΩïËÅîÂêà  üçÄ

`union` Âíå`union all` ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•ÂÆûÁé∞ , Â∞ÜÂ§ö‰∏™Ë°®ÁöÑÊï∞ÊçÆÊåâÁÖß‰∏ÄÂÆöÁöÑÊü•ËØ¢Êù°‰ª∂Êü•ËØ¢Âá∫Êù•Âêé , Â∞ÜÁªìÊûúÂêàÂπ∂Âà∞‰∏ÄËµ∑ÊòæÁ§∫

ËØ≠Ê≥ï : 

```mysql
SELECT * FROM t1
UNION\UNION ALL
SELECT * FROM t2
...
UNION\UNION ALL
SELECT * FROM tn;
```

ÂÆû‰æã : 

```mysql
mysql> SELECT deptno FROM emp
    -> UNION
    -> SELECT deptno FROM dept;
+--------+
| deptno |
+--------+
|      1 |
|      2 |
|      3 |
+--------+
3 rows in set (0.00 sec)
```

PS : `union all`ÊòØÊääÁªìÊûúÈõÜÁõ¥Êé•ÂêàÂπ∂Âú®‰∏ÄËµ∑ , ËÄå`union`ÊòØÂ∞Üunion allÂêéÁöÑÁªìÊûúËøõË°å‰∏ÄÊ¨°distinct , ÂéªÈô§ÈáçÂ§çËÆ∞ÂΩïÂêéÁöÑÁªìÊûú 

